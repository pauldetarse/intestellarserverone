<script>
	AjaxBehavior={
		property:{
		XMLHttp:Object,
		url:String,
		data:{
			type:Object,
			value:null
		
		},
		method:String
		},
		
	
	
	
	
	
	createXMlHttpRequestObject:function(url,data,method){
		this.url=url;
		this.data=data;
		this.method=method;
	 
	console.log(' createXMlHttpRequestObject')
	
    if(window.XMLHttpRequest) {
      this.xmlHttp = new XMLHttpRequest();  
    }else{
       this.xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    return this.xmlHttp;

	},
		
		
process:function(){
	var self=this;
	
	
	console.log(this.data);
	console.log(Object.keys(this.data));
	console.log('process');
	 this.xmlHttp.open (this.method, this.url, true);
            this.xmlHttp.onreadystatechange = this.handleStateChange.bind(this);
	if(this.method=='post'){
		this.xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
		Object.keys(this.data).forEach(function(key){
			console.log('key '+key);
			if(self.data.hasOwnProperty(key)){
				console.log('hasOwnProperty '+self.data[key]);
		   
		   	}
		});
		try{
		xmlhttp.send(this.data);
		}
		
		catch(e){
			 this.xmlHttp.send(this.data );  
		}
	} 

},
		
		
		handleStateChange:function(){
	console.log('handleStateChange'+this.xmlHttp.readyState);
    if (this.xmlHttp.readyState == 4) {
        if (this.xmlHttp.status == 200) {
           try {
			   console.log(this.xmlHttp.response)
                this.handleResponse.bind(this)();
           } catch (e) {
                
			   	console.log(e.toString(e));
           }
        } else {
            //alert ("handleStatechabge"+this.xmlHttp.statusText);
        }
    }

},
		

		};








</script>